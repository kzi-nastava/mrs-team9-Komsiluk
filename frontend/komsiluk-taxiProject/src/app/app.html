<app-navbar
  (menuClick)="toggleLeftSidebar()"
  (rightMenuClick)="toggleRightSidebar()"
  (filterClick)="toggleFilter()">
</app-navbar>

<app-leftsidebar [open]="isLeftSidebarOpen"></app-leftsidebar>
@if (rightOpen) {
  <div class="sidebar-backdrop" (click)="closeRightSidebar()"></div>
}
<app-rightsidebar [open]="rightOpen"></app-rightsidebar>

@if (filterSvc.open()) {
  <app-ride-history-filter-panel
    (filterApplied)="onFilterApplied($event)"
    (resetClicked)="onFilterReset()">
  </app-ride-history-filter-panel>
}

<router-outlet></router-outlet>
<app-toast></app-toast>

<app-confirm-booking-dialog
  [open]="confirmModal.isOpen()"
  [km]="confirmModal.vm()?.km ?? 0"
  [minutes]="confirmModal.vm()?.minutes ?? 0"
  [price]="confirmModal.vm()?.price ?? 0"
  (cancel)="confirmModal.close()"
  (confirm)="confirmModal.confirm()">
</app-confirm-booking-dialog>

<app-add-favorite-dialog
  [open]="addFavModal.open()"
  [defaultName]="addFavModal.data()?.defaultName ?? ''"
  (cancel)="addFavModal.close()"
  (confirm)="addFavModal.confirm($event)">
</app-add-favorite-dialog>

<app-favorite-details-dialog
  [open]="favDetailsModal.open()"
  [favorite]="favDetailsModal.data()?.favorite ?? null"
  [passengerEmails]="favDetailsModal.data()?.passengerEmails ?? []"
  (cancel)="favDetailsModal.close()"
  (delete)="onFavoriteDelete($event)"
  (rename)="onFavoriteRename($event)">
</app-favorite-details-dialog>

<app-rename-favorite-dialog
  [open]="renameFavModal.open()"
  [currentTitle]="renameFavModal.data()?.currentTitle ?? ''"
  (cancel)="renameFavModal.close()"
  (confirm)="renameFavModal.confirm($event)">
</app-rename-favorite-dialog>

<app-delete-favorite-dialog
  [open]="deleteFavModal.open()"
  [title]="deleteFavModal.data()?.title ?? ''"
  (cancel)="deleteFavModal.close()"
  (confirm)="deleteFavModal.confirm()">
</app-delete-favorite-dialog>

<app-scheduled-details-dialog
  [open]="schedDetailsModal.open()"
  [ride]="schedDetailsModal.data()?.ride ?? null"
  [passengerEmails]="schedDetailsModal.data()?.passengerEmails ?? []"
  (close)="schedDetailsModal.close()"
  (cancelRide)="onScheduledCancelRide($event)">
</app-scheduled-details-dialog>

<app-block-user-confirm-dialog
  [open]="blockUserModal.open()"
  [email]="blockUserModal.data()?.email ?? ''"
  (cancel)="blockUserModal.close()"
  (confirm)="blockUserModal.confirm($event)">
</app-block-user-confirm-dialog>

<app-account-blocked-dialog
  [open]="blockedModal.open()"
  [data]="blockedModal.data()"
  (closed)="blockedModal.close()">
</app-account-blocked-dialog>
